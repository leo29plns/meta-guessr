<!DOCTYPE html>
<html lang="fr" dir="ltr" data-mode>
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DataGuessr</title>

    <script>
    (() => {
      const stored = localStorage.getItem('mode');
      const system = window.matchMedia('(prefers-color-scheme: dark)').matches
        ? 'dark'
        : 'light';

      const mode = stored === 'dark' || stored === 'light' ? stored : system;

      document.documentElement.dataset.mode = mode;
    })();
    </script>

    <link rel="stylesheet" href="./index.css">

    <link rel="preconnect" href="https://tile.openstreetmap.org">

    <script type="importmap">
    {
      "imports": {
        "@/": "./",
        "leaflet": "./libraries/leaflet/leaflet-src.esm.js"
      }
    }
    </script>

    <!-- Global Metadata -->
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <link rel="icon" type="image/svg+xml" href="./favicon.svg">

    <!-- Primary Meta Tags -->
    <meta name="title" content="">
    <meta name="description" content="">

    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="">
    <meta property="og:title" content="">
    <meta property="og:description" content="">

    <!-- Twitter -->
    <meta property="twitter:url" content="">
    <meta property="twitter:title" content="">
    <meta property="twitter:description" content="">
    <meta property="twitter:image" content="">
  </head>
  <body>
    <main>
      <div class="gui">
        <div class="start">
          <aside class="metadata" id="metadata">
            <h1>map: metadata</h1>
            <dl>
              <div>
                <dt>Superficie</dt>
                <dd><span data-slot="superfic"></span>&nbsp;km²</dd>
              </div>
              <div>
                <dt>Naissances en 2022</dt>
                <dd><span data-slot="naiss2022"></span></dd>
              </div>
              <div>
                <dt>Décès en 2022</dt>
                <dd><span data-slot="deces2022"></span></dd>
              </div>
              <div>
                <dt>Revenu médian en 2020</dt>
                <dd><span data-slot="revMed2020"></span>&nbsp;€</dd>
              </div>
              <div>
                <dt>Prix moyen du m²</dt>
                <dd><span data-slot="achat_moyen_m2"></span>&nbsp;€</dd>
              </div>
              <div>
                <dt>Axe routier proche</dt>
                <dd><span data-slot="near_road"></span></dd>
              </div>
              <div>
                <dt>Monument notable</dt>
                <dd><span data-slot="near_monu"></span></dd>
              </div>
            </dl>
          </aside>
          <aside class="controls">
            <div class="settings">
              <button
                type="button"
                commandfor="settings"
                command="show-modal"
                aria-label="Ouvrir les paramètres"
              >
                <ui-icon name="settings"></ui-icon>
              </button>
            </div>
            <div class="zoom">
              <button
                type="button"
                id="zoom-in"
                class="button"
                aria-label="Faire un zoom avant"
              >
                <ui-icon name="plus"></ui-icon>
              </button>
              <button
                type="button"
                id="zoom-out"
                class="button"
                aria-label="Faire un zoom arrière"
              >
                <ui-icon name="minus"></ui-icon>
              </button>
            </div>
          </aside>
        </div>
        <div class="end">
          <aside class="layers">
            <form-group>
              <label for="layer">Layer</label>
              <select name="layer" id="layer">
                <option value="default">Base</option>
              </select>
            </form-group>
          </aside>
          <aside class="actions">
            <form action="" id="guess">
              <div class="form-hidden visually-hidden-focusable">
                <form-group>
                  <label for="lat">Latitude</label>
                  <input
                    type="number"
                    name="lat"
                    id="lat"
                    step="0.000001"
                    min="-180"
                    max="180"
                    required
                  >
                </form-group>
                <form-group>
                  <label for="lng">Longitude</label>
                  <input
                    type="number"
                    name="lng"
                    id="lng"
                    step="0.000001"
                    min="0"
                    max="360"
                    required
                  >
                </form-group>
              </div>
              <button type="submit">Guess!</button>
            </form>
          </aside>
        </div>
      </div>

      <div id="map"></div>
    </main>

    <aside popover="manual" id="round-score" class="round-score">
      <h1>Fin du tour <span data-slot="round-number"></span> </h1>
      <dl>
        <div>
          <dt>Distance</dt>
          <dd><span data-slot="distance"></span> km</dd>
        </div>
        <div>
          <dt>Score</dt>
          <dd><span data-slot="score"></span> points</dd>
        </div>
      </dl>
      <button data-action="next" aria-label="Passer au round suivant">
        Suivant <ui-icon name="x"></ui-icon>
      </button>
    </aside>

    <dialog id="game-score" class="score-score">
      <h1>Fin de jeu !</h1>

      <button data-action="next" aria-label="Terminer la partie">
        <ui-icon name="x"></ui-icon>
      </button>
    </dialog>

    <dialog id="settings" class="settings">
      <h1>Paramètres</h1>
      <fieldset>
        <legend>Mode de couleur :</legend>

        <form-group>
          <input type="radio" id="light" name="mode" value="light" checked>
          <label for="light">Light</label>
        </form-group>

        <form-group>
          <input type="radio" id="dark" name="mode" value="dark">
          <label for="dark">Dark</label>
        </form-group>

        <form-group>
          <input type="radio" id="system" name="mode" value="system">
          <label for="system">Système</label>
        </form-group>
      </fieldset>

      <button
        command="request-close"
        commandfor="settings"
        aria-label="Fermer les paramètres"
      >
        <ui-icon name="x"></ui-icon>
      </button>
    </dialog>

    <template id="template-ui-icon">
      <svg></svg>
    </template>

    <template id="template-data-scale">
      <style>
      @import url("components/data-scale/data-scale.css");
      </style>

      <div class="container">
        <p>
          <slot></slot>
        </p>
      </div>
    </template>

    <script type="module" src="./index.js"></script>
  </body>
</html>
